	!-------------------------------------------------------------------------------------------!
	!										Question 5											!
	!-------------------------------------------------------------------------------------------!
	!###########################################################################################!
	!-------------------------------------------------------------------------------------------!
	!									   Main Function										!
	!-------------------------------------------------------------------------------------------!
	!									Declare all variable									!
	!-------------------------------------------------------------------------------------------!	
		real time(1000),t_vel(1000),t_pos(1000)
		real p_vel(1000),p_pos(1000)
		real t0,z0,v0, t,z,v 
		real dt, v_lim
		real err_vel(1000),err_pos(1000)
		real diff_vel,diff_pos 
	!-------------------------------------------------------------------------------------------!
	!								All given Data from Question								!
	!-------------------------------------------------------------------------------------------!	
		dt = 15.0e-6				! Time inteval 
		t0 = 0.0					! Initial time (in sec) 
		z0 = 7.5					! Total distance (in metre)
		v0 = -1.5					! Initial velocity (in m/s) 
		v_lim = 1.5 				! Final limit (in m/s)
	!-------------------------------------------------------------------------------------------!	
	t=0
	i=1
10	time(i)=t
	t_vel(i)=vel(t)
	t_pos(i)=pos(t)
	z=vel(t)
	t=t+dt
	i=i+1
	if(z.lt.v_lim) goto 10
	!-------------------------------------------------------------------------------------------!
	!					Taking Output Data: Time -- Position -- Velocity						!
	!-------------------------------------------------------------------------------------------!	
		p_vel(1)=v0
		p_pos(1)=z0
		j=2 
	20  t = t0
		z = z0 
		v = v0
		call rk4(t,z,v)
		p_vel(j)=v
		p_pos(j)=z
		t0 = t
		z0 = z 
		v0 = v 
		j=j+1
		if (v.lt.v_lim) goto 20
	!-------------------------------------------------------------------------------------------!
	!				   Calculating percentage error in postion and velocity						!     
	!-------------------------------------------------------------------------------------------!			 
		open(unit=1,file='theo_output.dat')
		open(unit=2,file='prac_output.dat')
		open(unit=3,file='error.dat')
		do k=1,j-1
		diff_vel=t_vel(k)-p_vel(k)
		diff_pos=t_pos(k)-p_pos(k)
		err_vel(k)=diff_vel/t_vel(k)*100
		err_pos(k)=diff_pos/t_pos(k)*100
		write(*,*) p_pos(k),err_vel(k),err_pos(k)
		write(1,*) time(k),t_vel(k),t_pos(k)
		write(2,*) time(k),p_vel(k),p_pos(k)
		write(3,*) p_pos(k),err_vel(k),err_pos(k)
		enddo																						    
		close(1)
		write(*,*) "All Done...!"
		stop
		end
	!-------------------------------------------------------------------------------------------!
	!##############################		End Main Function	  ##################################!
	!-------------------------------------------------------------------------------------------!	
	!-------------------------------------------------------------------------------------------!
	!						Runge Kutta (4th order) - 2nd order ODE								!
	!-------------------------------------------------------------------------------------------!		
	subroutine rk4(t,z,v)
		real f1,f2,t,z,v,dt
		real k1,k2,k3,k4
		real l1,l2,l3,l4

		dt = 15.0e-6

		k1 = f1(t,z,v)
		l1 = f2(t,z,v)

		k2 = f1(t+0.5*dt,z+0.5*dt*l1,v+0.5*dt*k1)
		l2 = f2(t+0.5*dt,z+0.5*dt*l1,v+0.5*dt*k1)

		k3 = f1(t+0.5*dt,z+0.5*dt*l2,v+0.5*dt*k2)
		l3 = f2(t+0.5*dt,z+0.5*dt*l2,v+0.5*dt*k2)

		k4 = f1(t+dt,z+dt*l3,v+dt*k3)
		l4 = f2(t+dt,z+dt*l3,v+dt*k3)

		z = z + dt*(l1+2.0*(l2+l3)+l4)/6.0
		v = v + dt*(k1+2.0*(k2+k3)+k4)/6.0
		t = t + dt
	return
	end
	!-------------------------------------------------------------------------------------------!
	!								Function for Acceleration									!
	!-------------------------------------------------------------------------------------------!	
	function f1(t,z,v) 
		real f1,t,z,v
		real q,E,m,g 
		q = 0.2				! q = charge (in coulomb)
		E = 20.0 			! E = electric field (in V/m)
		m = 0.01			! m = mass (in Kg) 
		g = 9.8 			! g = gravitational field (m/s2)
		f1 = q*E/m - g + 0.0*t*z*v
	return 
	end
	!-------------------------------------------------------------------------------------------!
	!								Function for velocity										!
	!-------------------------------------------------------------------------------------------!	
	function f2(t,z,v) 
		real f2,t,z,v
		f2 = v + 0.0*t*z 
	return 
	end 
	!-------------------------------------------------------------------------------------------!
	!							(theoretical) Function for velocity	     						!
	!-------------------------------------------------------------------------------------------!
	function vel(t)
	real m,q,E,g
	real vel,u,t
	m=0.01						! m = mass in Kg
	q=0.2						! q = charge in coulomb
	E=20						! E = electric field in V/m
	g=9.8						! g = gravitational field in m/s2
	u=q*E/m-g
	vel=u*t-1.5
	return
	end
	!---------------------------------------------------------------------------------------------!
	!							(theoretical) Function for position			      				  !
	!---------------------------------------------------------------------------------------------!
	function pos(t)
	real m,q,E,g
	real v,u,t,pos
	m=0.01						! m = mass in Kg
	q=0.2						! q = charge in coulomb
	E=20						! E = electric field in V/m
	g=9.8						! g = gravitational field in m/s2
	u=q*E/m-g
	v=0.5*u*t*t
	pos=v-1.5*t+7.5
	return
	end
	!-------------------------------------------------------------------------------------------!
	!-------------------------------------------------------------------------------------------!	
	!|||||||||||||||||||||||||||||			End Program		||||||||||||||||||||||||||||||||||||!		
	!-------------------------------------------------------------------------------------------!	
