	!-------------------------------------------------------------------------------------------!
	!								     Question 6												!
	!-------------------------------------------------------------------------------------------!
	!###########################################################################################!
	!-------------------------------------------------------------------------------------------!
	!									Main Function											!
	!-------------------------------------------------------------------------------------------!
	!								all	declared variables										!
	!-------------------------------------------------------------------------------------------!
	real a, b, h, hv, ha
	integer n, nv, nx
	real tt,acln,m
	real t(0:1000)
	real v(0:1000),vs(0:1000)
	real x(0:1000),acc(0:10),vel(0:10)
	real sum,q,E,t_vel,t_pos,t_ke
	real ae_pos,ae_ke,ke_end,err_pos,err_ke
	!-------------------------------------------------------------------------------------------!
	!								all	given data from question								!		
	!-------------------------------------------------------------------------------------------!
	m = 1.67e-27		!mass of hydrogen ion
	q= 1.602e-19		!charge of electric field
	E=10				!electric field in V/m 
	h=0.5				!step size of time for data set
	n=10				!number of data points for the calculation of simson integral
	a=0.				!lowerlimit of integral
	b=15.				!upper maximum limit
	nx=int((b-a)/h)		!numberof position needed
	nv=nx*n				!number od velocoity point needed for the calculation of position
	hv=(b-a)/nv			!step size for velocity
	!--------------------------------------------------------------------------------------------!
	na=nv*n
	ha=(b-a)/na

	v(0)=0
	x(0)=0
	!-------------------------------------------------------------------------------------------!
	!								Calculating velocity										!
	!-------------------------------------------------------------------------------------------!
	do i=1,nv
		do j=0,n
		tt=a+float((i-1)*n+j)*ha
		acc(j)=acln(tt)
		enddo
	call simpson(n,ha,acc,sum)
	v(i)=v(i-1)+sum
	enddo
	do i=0,nx
	vs(i)=v(i*n)
	enddo
	!-------------------------------------------------------------------------------------------!
	!								Calculating position										!
	!-------------------------------------------------------------------------------------------!
	do i=1,nx
		do j=0,n
		k=((i-1)*n+j)
		tt=a+float((i-1)*n+j)*hv
		vel(j)=v(k)
		enddo
	call simpson(n,hv,vel,sum)
	x(i)=x(i-1)+sum
	t(i)=a+float(i)*h
	enddo
	!-------------------------------------------------------------------------------------------!
	!			Calculating theoretical velocity,position and kinetic energy					!
	!-------------------------------------------------------------------------------------------!
	t_vel=15.*q*E/m							!theoritical velocity at end point 
	t_pos=15.*t_vel*0.5							!theoritical position at end point 
	t_ke=t_vel*t_vel*m*.5					!theoritical kinetic energy at end point 
	!-------------------------------------------------------------------------------------------!
	!			Calculating percentage error in -- position -- kinetic energy					!
	!-------------------------------------------------------------------------------------------!
	open(unit=2,file="error.dat")
	ae_pos=abs(t_pos-x(nx))			! absolute error in position				
	err_pos=ae_pos/t_pos*100.		! percentage error in position
	ke_end=vs(nx)*vs(nx)*m*.5		! kinetic energy at end position
	ae_ke=abs(t_ke-ke_end)			! absolute error in position
	err_ke=ae_ke/t_ke*100.			! percentage error in position
	write(2,*) "Error at position : ",err_pos
	write(2,*) "Error at velocity : ",err_ke
	write(*,*) "At ppsition",t_pos,"error is: ",err_pos
	write(*,*) "At velocity: ",t_ke," error is: ",err_ke

	!-------------------------------------------------------------------------------------------!
	!			Taking output as time -- position -- velocity -- kinetic energy					!
	!-------------------------------------------------------------------------------------------!
	open(unit=1,file="output.dat")
	write(*,*)"	Time	   position	  velocity	  kinetic energy"
	do i=0,nx
	write(*,*) t(i),x(i),vs(i),vs(i)*vs(i)*m*.5
	write(1,*) t(i),x(i),vs(i),vs(i)*vs(i)*m*.5
	enddo
	write(*,*) "All done ...."
	stop
	end
	!-------------------------------------------------------------------------------------------!
	!###########################################################################################!
	!-------------------------------------------------------------------------------------------!
	!-------------------------------------------------------------------------------------------!
	!								subroutine for simpson										!
	!-------------------------------------------------------------------------------------------!
	subroutine simpson(n,h,y,fx)
	real h,fx
	integer n, i
	real y(0:n)
	fx=y(0)+y(n)
	do i=1,n-1
	if(mod(i,2).ne.0.) then
	fx=fx+4.*y(i)
	else
	fx=fx+2.*y(i)
	endif
	enddo
	fx=fx*h/3.
	return
	end
	!-------------------------------------------------------------------------------------------!
	!###########################################################################################!
	!-------------------------------------------------------------------------------------------!
	!-------------------------------------------------------------------------------------------!
	!								Function of acceleration									!
	!-------------------------------------------------------------------------------------------!
	function acln(t)
		real q,e,m,acln,t
		t=0. 
		q = 1.602e-19
		m = 1.67e-27
		e = 10.
		acln=q*e/m + 0.0*t
	return
	end
	!-------------------------------------------------------------------------------------------!
	!								      End Prpgram											!
	!-------------------------------------------------------------------------------------------!
	!-------------------------------------------------------------------------------------------!
	!###########################################################################################!
	!-------------------------------------------------------------------------------------------!
